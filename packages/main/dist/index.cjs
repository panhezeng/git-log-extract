"use strict";
const electron = require("electron");
const path = require("path");
const url = require("url");
const Store = require("electron-store");
const fs = require("fs-extra");
const simpleGit = require("simple-git");
const _interopDefaultLegacy = (e) => e && typeof e === "object" && "default" in e ? e : { default: e };
const path__default = /* @__PURE__ */ _interopDefaultLegacy(path);
const Store__default = /* @__PURE__ */ _interopDefaultLegacy(Store);
const fs__default = /* @__PURE__ */ _interopDefaultLegacy(fs);
const simpleGit__default = /* @__PURE__ */ _interopDefaultLegacy(simpleGit);
async function createWindow() {
  const browserWindow = new electron.BrowserWindow({
    show: false,
    webPreferences: {
      preload: path.join(electron.app.getAppPath(), "packages/preload/dist/index.cjs")
    }
  });
  browserWindow.on("ready-to-show", () => {
    browserWindow == null ? void 0 : browserWindow.show();
    {
      browserWindow == null ? void 0 : browserWindow.webContents.openDevTools();
    }
  });
  const pageUrl = "http://localhost:5174/";
  await browserWindow.loadURL(pageUrl);
  return browserWindow;
}
async function restoreOrCreateWindow() {
  let window = electron.BrowserWindow.getAllWindows().find((w) => !w.isDestroyed());
  if (window === void 0) {
    window = await createWindow();
  }
  if (window.isMinimized()) {
    window.restore();
  }
  window.focus();
}
const channel = {
  app: {
    getPath: "getPath"
  },
  dialog: "dialog",
  path: {
    resolve: "resolve"
  },
  fs: {
    existsSync: "existsSync",
    removeSync: "removeSync",
    emptyDirSync: "emptyDirSync"
  },
  store: {
    get: "get",
    set: "set"
  },
  git: {
    repositoryAuthUrl: "repositoryAuthUrl",
    branchSummary: "branchSummary",
    logResult: "logResult"
  }
};
const appTitle = "Git Log Extract";
electron.ipcMain.handle(channel.dialog, async (event, options) => {
  return await electron.dialog.showOpenDialog(options);
});
electron.ipcMain.on(
  channel.app.getPath,
  async (event, ...args) => {
    event.returnValue = electron.app.getPath(...args);
  }
);
electron.ipcMain.on(
  channel.path.resolve,
  async (event, ...args) => {
    event.returnValue = path__default.default.resolve(...args);
  }
);
electron.ipcMain.on(
  channel.fs.existsSync,
  async (event, ...args) => {
    event.returnValue = fs__default.default.existsSync(...args);
  }
);
electron.ipcMain.on(
  channel.fs.removeSync,
  async (event, ...args) => {
    event.returnValue = fs__default.default.removeSync(...args);
  }
);
electron.ipcMain.on(
  channel.fs.emptyDirSync,
  async (event, ...args) => {
    event.returnValue = fs__default.default.emptyDirSync(...args);
  }
);
const store = new Store__default.default({
  name: "git-log-extract-main-config",
  cwd: electron.app.getPath("appData") + "/" + appTitle
});
electron.ipcMain.on(channel.store.set, async (event, ...args) => {
  store.set(...args);
});
electron.ipcMain.on(channel.store.get, async (event, key, defaultValue) => {
  event.returnValue = store.get(key, defaultValue);
});
electron.ipcMain.handle(
  channel.git.repositoryAuthUrl,
  async (event, url$1, username, password) => {
    const urlObj = new url.URL(url$1);
    urlObj.username = username;
    urlObj.password = password;
    return urlObj.href;
  }
);
function createGit(options, onProgress) {
  if (typeof options === "undefined") {
    options = { baseDir: "" };
  }
  const git = simpleGit__default.default(options);
  git.outputHandler((bin, stdout, stderr, args) => {
    stdout.pipe(process.stdout);
    stderr.pipe(process.stderr);
    stderr.on("data", function(stdData) {
      if (onProgress) {
        onProgress(stdData.toString());
      }
    });
  });
  return git;
}
electron.ipcMain.handle(
  channel.git.branchSummary,
  async (event, directoryPath, repositoryAuthUrl) => {
    const git = createGit({
      baseDir: directoryPath
    });
    await git.init();
    await git.addRemote("origin", repositoryAuthUrl);
    await git.fetch(['--shallow-since="1 months ago"']);
    const branchSummary = await git.branch(["-r"]);
    return branchSummary;
  }
);
electron.ipcMain.handle(
  channel.git.logResult,
  async (event, directoryPath, logOptions) => {
    const git = createGit({ baseDir: directoryPath });
    await git.fetch(['--shallow-since="1 months ago"']);
    const logResult = await git.log(logOptions);
    return logResult;
  }
);
const isSingleInstance = electron.app.requestSingleInstanceLock();
if (!isSingleInstance) {
  electron.app.quit();
  process.exit(0);
}
electron.app.on("second-instance", restoreOrCreateWindow);
electron.app.disableHardwareAcceleration();
electron.app.on("window-all-closed", () => {
  if (process.platform !== "darwin") {
    electron.app.quit();
  }
});
electron.app.on("activate", restoreOrCreateWindow);
electron.app.whenReady().then(restoreOrCreateWindow).catch((e) => console.error("Failed create window:", e));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguY2pzIiwic291cmNlcyI6WyIuLi9zcmMvbWFpbldpbmRvdy50cyIsIi4uLy4uL2NvbW1vbi9zcmMvY2hhbm5lbC50cyIsIi4uL3NyYy9saXN0ZW5lci50cyIsIi4uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2FwcCwgQnJvd3NlcldpbmRvd30gZnJvbSAnZWxlY3Ryb24nO1xuaW1wb3J0IHtqb2lufSBmcm9tICdwYXRoJztcbmltcG9ydCB7VVJMfSBmcm9tICd1cmwnO1xuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVXaW5kb3coKSB7XG4gIGNvbnN0IGJyb3dzZXJXaW5kb3cgPSBuZXcgQnJvd3NlcldpbmRvdyh7XG4gICAgc2hvdzogZmFsc2UsIC8vIFVzZSB0aGUgJ3JlYWR5LXRvLXNob3cnIGV2ZW50IHRvIHNob3cgdGhlIGluc3RhbnRpYXRlZCBCcm93c2VyV2luZG93LlxuICAgIHdlYlByZWZlcmVuY2VzOiB7XG4gICAgICBwcmVsb2FkOiBqb2luKGFwcC5nZXRBcHBQYXRoKCksICdwYWNrYWdlcy9wcmVsb2FkL2Rpc3QvaW5kZXguY2pzJyksXG4gICAgfSxcbiAgfSk7XG5cbiAgLyoqXG4gICAqIElmIHRoZSAnc2hvdycgcHJvcGVydHkgb2YgdGhlIEJyb3dzZXJXaW5kb3cncyBjb25zdHJ1Y3RvciBpcyBvbWl0dGVkIGZyb20gdGhlIGluaXRpYWxpemF0aW9uIG9wdGlvbnMsXG4gICAqIGl0IHRoZW4gZGVmYXVsdHMgdG8gJ3RydWUnLiBUaGlzIGNhbiBjYXVzZSBmbGlja2VyaW5nIGFzIHRoZSB3aW5kb3cgbG9hZHMgdGhlIGh0bWwgY29udGVudCxcbiAgICogYW5kIGl0IGFsc28gaGFzIHNob3cgcHJvYmxlbWF0aWMgYmVoYXZpb3VyIHdpdGggdGhlIGNsb3Npbmcgb2YgdGhlIHdpbmRvdy5cbiAgICogVXNlIGBzaG93OiBmYWxzZWAgYW5kIGxpc3RlbiB0byB0aGUgIGByZWFkeS10by1zaG93YCBldmVudCB0byBzaG93IHRoZSB3aW5kb3cuXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2VsZWN0cm9uL2VsZWN0cm9uL2lzc3Vlcy8yNTAxMiBmb3IgdGhlIGFmZm9yZCBtZW50aW9uZWQgaXNzdWUuXG4gICAqL1xuICBicm93c2VyV2luZG93Lm9uKCdyZWFkeS10by1zaG93JywgKCkgPT4ge1xuICAgIGJyb3dzZXJXaW5kb3c/LnNob3coKTtcblxuICAgIGlmIChpbXBvcnQubWV0YS5lbnYuREVWKSB7XG4gICAgICBicm93c2VyV2luZG93Py53ZWJDb250ZW50cy5vcGVuRGV2VG9vbHMoKTtcbiAgICB9XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBVUkwgZm9yIG1haW4gd2luZG93LlxuICAgKiBWaXRlIGRldiBzZXJ2ZXIgZm9yIGRldmVsb3BtZW50LlxuICAgKiBgZmlsZTovLy4uL3JlbmRlcmVyL2luZGV4Lmh0bWxgIGZvciBwcm9kdWN0aW9uIGFuZCB0ZXN0LlxuICAgKi9cbiAgY29uc3QgcGFnZVVybCA9XG4gICAgaW1wb3J0Lm1ldGEuZW52LkRFViAmJiBpbXBvcnQubWV0YS5lbnYuVklURV9ERVZfU0VSVkVSX1VSTCAhPT0gdW5kZWZpbmVkXG4gICAgICA/IGltcG9ydC5tZXRhLmVudi5WSVRFX0RFVl9TRVJWRVJfVVJMXG4gICAgICA6IG5ldyBVUkwoJy4uL3JlbmRlcmVyL2Rpc3QvaW5kZXguaHRtbCcsICdmaWxlOi8vJyArIF9fZGlybmFtZSkudG9TdHJpbmcoKTtcblxuICBhd2FpdCBicm93c2VyV2luZG93LmxvYWRVUkwocGFnZVVybCk7XG5cbiAgcmV0dXJuIGJyb3dzZXJXaW5kb3c7XG59XG5cbi8qKlxuICogUmVzdG9yZSBhbiBleGlzdGluZyBCcm93c2VyV2luZG93IG9yIENyZWF0ZSBhIG5ldyBCcm93c2VyV2luZG93LlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVzdG9yZU9yQ3JlYXRlV2luZG93KCkge1xuICBsZXQgd2luZG93ID0gQnJvd3NlcldpbmRvdy5nZXRBbGxXaW5kb3dzKCkuZmluZCh3ID0+ICF3LmlzRGVzdHJveWVkKCkpO1xuXG4gIGlmICh3aW5kb3cgPT09IHVuZGVmaW5lZCkge1xuICAgIHdpbmRvdyA9IGF3YWl0IGNyZWF0ZVdpbmRvdygpO1xuICB9XG5cbiAgaWYgKHdpbmRvdy5pc01pbmltaXplZCgpKSB7XG4gICAgd2luZG93LnJlc3RvcmUoKTtcbiAgfVxuXG4gIHdpbmRvdy5mb2N1cygpO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQge1xuICBhcHA6IHtcbiAgICBnZXRQYXRoOiAnZ2V0UGF0aCcsXG4gIH0sXG4gIGRpYWxvZzogJ2RpYWxvZycsXG4gIHBhdGg6IHtcbiAgICByZXNvbHZlOiAncmVzb2x2ZScsXG4gIH0sXG4gIGZzOiB7XG4gICAgZXhpc3RzU3luYzogJ2V4aXN0c1N5bmMnLFxuICAgIHJlbW92ZVN5bmM6ICdyZW1vdmVTeW5jJyxcbiAgICBlbXB0eURpclN5bmM6ICdlbXB0eURpclN5bmMnLFxuICB9LFxuICBzdG9yZToge1xuICAgIGdldDogJ2dldCcsXG4gICAgc2V0OiAnc2V0JyxcbiAgfSxcbiAgZ2l0OiB7XG4gICAgcmVwb3NpdG9yeUF1dGhVcmw6ICdyZXBvc2l0b3J5QXV0aFVybCcsXG4gICAgYnJhbmNoU3VtbWFyeTogJ2JyYW5jaFN1bW1hcnknLFxuICAgIGxvZ1Jlc3VsdDogJ2xvZ1Jlc3VsdCcsXG4gIH0sXG59O1xuIiwiaW1wb3J0IHR5cGUge1dpbmRvd0VsZWN0cm9uUGFyYW1ldGVyc30gZnJvbSAnKi52dWV8dHN8dHN4JztcbmltcG9ydCBjaGFubmVsIGZyb20gJ0AvY29tbW9uL2NoYW5uZWwnO1xuaW1wb3J0IHthcHBUaXRsZX0gZnJvbSAnQC9jb21tb24vaW5kZXguanNvbic7XG5pbXBvcnQgdHlwZSB7T3BlbkRpYWxvZ09wdGlvbnN9IGZyb20gJ2VsZWN0cm9uJztcbmltcG9ydCB7YXBwLCBkaWFsb2csIGlwY01haW59IGZyb20gJ2VsZWN0cm9uJztcbmltcG9ydCBTdG9yZSBmcm9tICdlbGVjdHJvbi1zdG9yZSc7XG5pbXBvcnQgZnMgZnJvbSAnZnMtZXh0cmEnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgdHlwZSB7QnJhbmNoU3VtbWFyeSwgTG9nUmVzdWx0LCBTaW1wbGVHaXRPcHRpb25zfSBmcm9tICdzaW1wbGUtZ2l0JztcbmltcG9ydCBzaW1wbGVHaXQgZnJvbSAnc2ltcGxlLWdpdCc7XG5pbXBvcnQge1VSTH0gZnJvbSAndXJsJztcbi8vXG4vLyBpcGNNYWluLmhhbmRsZSgnZWxlY3Ryb25FeGFtcGxlSGFuZGxlJywgYXN5bmMgKGV2ZW50LCAuLi5hcmdzKSA9PiB7fSk7XG4vLyBpcGNNYWluLm9uKCdlbGVjdHJvbkV4YW1wbGVPbicsIGFzeW5jIChldmVudCwgLi4uYXJncykgPT4ge1xuLy8gICBldmVudC5yZXR1cm5WYWx1ZSA9ICcnO1xuLy8gfSk7XG5cbi8vIGVsZWN0cm9uIHN0YXJ0XG5pcGNNYWluLmhhbmRsZShjaGFubmVsLmRpYWxvZywgYXN5bmMgKGV2ZW50LCBvcHRpb25zOiBPcGVuRGlhbG9nT3B0aW9ucykgPT4ge1xuICByZXR1cm4gYXdhaXQgZGlhbG9nLnNob3dPcGVuRGlhbG9nKG9wdGlvbnMpO1xufSk7XG5cbmlwY01haW4ub24oXG4gIGNoYW5uZWwuYXBwLmdldFBhdGgsXG4gIGFzeW5jIChldmVudCwgLi4uYXJnczogV2luZG93RWxlY3Ryb25QYXJhbWV0ZXJzWydhcHAnXVsnZ2V0UGF0aCddKSA9PiB7XG4gICAgZXZlbnQucmV0dXJuVmFsdWUgPSBhcHAuZ2V0UGF0aCguLi5hcmdzKTtcbiAgfSxcbik7XG4vLyBlbGVjdHJvbiBlbmRcblxuLy8gbm9kZSBzdGFydFxuaXBjTWFpbi5vbihcbiAgY2hhbm5lbC5wYXRoLnJlc29sdmUsXG4gIGFzeW5jIChldmVudCwgLi4uYXJnczogV2luZG93RWxlY3Ryb25QYXJhbWV0ZXJzWydwYXRoJ11bJ3Jlc29sdmUnXSkgPT4ge1xuICAgIGV2ZW50LnJldHVyblZhbHVlID0gcGF0aC5yZXNvbHZlKC4uLmFyZ3MpO1xuICB9LFxuKTtcblxuaXBjTWFpbi5vbihcbiAgY2hhbm5lbC5mcy5leGlzdHNTeW5jLFxuICBhc3luYyAoZXZlbnQsIC4uLmFyZ3M6IFdpbmRvd0VsZWN0cm9uUGFyYW1ldGVyc1snZnMnXVsnZXhpc3RzU3luYyddKSA9PiB7XG4gICAgZXZlbnQucmV0dXJuVmFsdWUgPSBmcy5leGlzdHNTeW5jKC4uLmFyZ3MpO1xuICB9LFxuKTtcblxuaXBjTWFpbi5vbihcbiAgY2hhbm5lbC5mcy5yZW1vdmVTeW5jLFxuICBhc3luYyAoZXZlbnQsIC4uLmFyZ3M6IFdpbmRvd0VsZWN0cm9uUGFyYW1ldGVyc1snZnMnXVsncmVtb3ZlU3luYyddKSA9PiB7XG4gICAgZXZlbnQucmV0dXJuVmFsdWUgPSBmcy5yZW1vdmVTeW5jKC4uLmFyZ3MpO1xuICB9LFxuKTtcblxuaXBjTWFpbi5vbihcbiAgY2hhbm5lbC5mcy5lbXB0eURpclN5bmMsXG4gIGFzeW5jIChldmVudCwgLi4uYXJnczogV2luZG93RWxlY3Ryb25QYXJhbWV0ZXJzWydmcyddWydlbXB0eURpclN5bmMnXSkgPT4ge1xuICAgIGV2ZW50LnJldHVyblZhbHVlID0gZnMuZW1wdHlEaXJTeW5jKC4uLmFyZ3MpO1xuICB9LFxuKTtcblxuLy8gbm9kZSBlbmRcblxuY29uc3Qgc3RvcmUgPSBuZXcgU3RvcmUoe1xuICBuYW1lOiAnZ2l0LWxvZy1leHRyYWN0LW1haW4tY29uZmlnJyxcbiAgY3dkOiBhcHAuZ2V0UGF0aCgnYXBwRGF0YScpICsgJy8nICsgYXBwVGl0bGUsXG59KTtcblxuaXBjTWFpbi5vbihjaGFubmVsLnN0b3JlLnNldCwgYXN5bmMgKGV2ZW50LCAuLi5hcmdzOiBXaW5kb3dFbGVjdHJvblBhcmFtZXRlcnNbJ3N0b3JlJ11bJ3NldCddKSA9PiB7XG4gIHN0b3JlLnNldCguLi5hcmdzKTtcbn0pO1xuXG5pcGNNYWluLm9uKGNoYW5uZWwuc3RvcmUuZ2V0LCBhc3luYyAoZXZlbnQsIGtleTogc3RyaW5nLCBkZWZhdWx0VmFsdWU/OiB1bmtub3duKSA9PiB7XG4gIGV2ZW50LnJldHVyblZhbHVlID0gc3RvcmUuZ2V0KGtleSwgZGVmYXVsdFZhbHVlKTtcbn0pO1xuXG5pcGNNYWluLmhhbmRsZShcbiAgY2hhbm5lbC5naXQucmVwb3NpdG9yeUF1dGhVcmwsXG4gIGFzeW5jIChldmVudCwgdXJsOiBzdHJpbmcsIHVzZXJuYW1lOiBzdHJpbmcsIHBhc3N3b3JkOiBzdHJpbmcpID0+IHtcbiAgICBjb25zdCB1cmxPYmogPSBuZXcgVVJMKHVybCk7XG4gICAgdXJsT2JqLnVzZXJuYW1lID0gdXNlcm5hbWU7XG4gICAgdXJsT2JqLnBhc3N3b3JkID0gcGFzc3dvcmQ7XG4gICAgcmV0dXJuIHVybE9iai5ocmVmO1xuICB9LFxuKTtcblxuZnVuY3Rpb24gY3JlYXRlR2l0KG9wdGlvbnM/OiBQYXJ0aWFsPFNpbXBsZUdpdE9wdGlvbnM+LCBvblByb2dyZXNzPzogKGRhdGE6IHN0cmluZykgPT4gdm9pZCkge1xuICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgb3B0aW9ucyA9IHtiYXNlRGlyOiAnJ307XG4gIH1cbiAgLy8gaWYgKG9uUHJvZ3Jlc3MpIHtcbiAgLy8gICBvcHRpb25zLnByb2dyZXNzICA9IChkYXRhOiBTaW1wbGVHaXRQcm9ncmVzc0V2ZW50KSA9PiB7XG4gIC8vICAgICBjb25zb2xlLmxvZyhcbiAgLy8gICAgICAgYGdpdC4ke2RhdGEubWV0aG9kfSAke2RhdGEuc3RhZ2V9IHN0YWdlICR7ZGF0YS5wcm9ncmVzc30lIGNvbXBsZXRlYFxuICAvLyAgICAgKTtcbiAgLy8gICAgIG9uUHJvZ3Jlc3MoZGF0YSk7XG4gIC8vICAgfTtcbiAgLy8gfVxuICBjb25zdCBnaXQgPSBzaW1wbGVHaXQob3B0aW9ucyk7XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICBnaXQub3V0cHV0SGFuZGxlcigoYmluLCBzdGRvdXQsIHN0ZGVyciwgYXJncykgPT4ge1xuICAgIHN0ZG91dC5waXBlKHByb2Nlc3Muc3Rkb3V0KTtcbiAgICBzdGRlcnIucGlwZShwcm9jZXNzLnN0ZGVycik7XG4gICAgc3RkZXJyLm9uKCdkYXRhJywgZnVuY3Rpb24gKHN0ZERhdGE6IHt0b1N0cmluZzogKCkgPT4gc3RyaW5nfSkge1xuICAgICAgLy8gY29uc29sZS5sb2coc3RkRGF0YS50b1N0cmluZygpKTtcbiAgICAgIGlmIChvblByb2dyZXNzKSB7XG4gICAgICAgIG9uUHJvZ3Jlc3Moc3RkRGF0YS50b1N0cmluZygpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG4gIHJldHVybiBnaXQ7XG59XG5cbmlwY01haW4uaGFuZGxlKFxuICBjaGFubmVsLmdpdC5icmFuY2hTdW1tYXJ5LFxuICBhc3luYyAoZXZlbnQsIGRpcmVjdG9yeVBhdGg6IHN0cmluZywgcmVwb3NpdG9yeUF1dGhVcmw6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IGdpdCA9IGNyZWF0ZUdpdCh7XG4gICAgICBiYXNlRGlyOiBkaXJlY3RvcnlQYXRoLFxuICAgIH0pO1xuICAgIGF3YWl0IGdpdC5pbml0KCk7XG4gICAgYXdhaXQgZ2l0LmFkZFJlbW90ZSgnb3JpZ2luJywgcmVwb3NpdG9yeUF1dGhVcmwpO1xuICAgIGF3YWl0IGdpdC5mZXRjaChbJy0tc2hhbGxvdy1zaW5jZT1cIjEgbW9udGhzIGFnb1wiJ10pO1xuICAgIC8vIGF3YWl0IGdpdC5yZW1vdGUoW1widXBkYXRlXCJdKTtcbiAgICBjb25zdCBicmFuY2hTdW1tYXJ5OiBCcmFuY2hTdW1tYXJ5ID0gYXdhaXQgZ2l0LmJyYW5jaChbJy1yJ10pO1xuICAgIHJldHVybiBicmFuY2hTdW1tYXJ5O1xuICB9LFxuKTtcblxuaXBjTWFpbi5oYW5kbGUoXG4gIGNoYW5uZWwuZ2l0LmxvZ1Jlc3VsdCxcbiAgYXN5bmMgKGV2ZW50LCBkaXJlY3RvcnlQYXRoOiBzdHJpbmcsIGxvZ09wdGlvbnM6IHN0cmluZ1tdKSA9PiB7XG4gICAgY29uc3QgZ2l0ID0gY3JlYXRlR2l0KHtiYXNlRGlyOiBkaXJlY3RvcnlQYXRofSk7XG4gICAgYXdhaXQgZ2l0LmZldGNoKFsnLS1zaGFsbG93LXNpbmNlPVwiMSBtb250aHMgYWdvXCInXSk7XG4gICAgLy8gY29uc29sZS5sb2coJ2dpdCAxJyk7XG4gICAgLy8gYXdhaXQgZ2l0LnJlbW90ZShbXCJ1cGRhdGVcIl0pO1xuICAgIC8vIC8vIGNvbnNvbGUubG9nKCdnaXQgMicpO1xuICAgIGNvbnN0IGxvZ1Jlc3VsdDogTG9nUmVzdWx0ID0gYXdhaXQgZ2l0LmxvZyhsb2dPcHRpb25zKTtcbiAgICAvLyBjb25zb2xlLmxvZygnZ2l0IDMnKTtcbiAgICByZXR1cm4gbG9nUmVzdWx0O1xuICB9LFxuKTtcbiIsImltcG9ydCB7cmVzdG9yZU9yQ3JlYXRlV2luZG93fSBmcm9tICdAL21haW4vbWFpbldpbmRvdyc7XG5pbXBvcnQge2FwcH0gZnJvbSAnZWxlY3Ryb24nO1xuaW1wb3J0ICcuL2xpc3RlbmVyJztcbi8qKlxuICogUHJldmVudCBlbGVjdHJvbiBmcm9tIHJ1bm5pbmcgbXVsdGlwbGUgaW5zdGFuY2VzLlxuICovXG5jb25zdCBpc1NpbmdsZUluc3RhbmNlID0gYXBwLnJlcXVlc3RTaW5nbGVJbnN0YW5jZUxvY2soKTtcbmlmICghaXNTaW5nbGVJbnN0YW5jZSkge1xuICBhcHAucXVpdCgpO1xuICBwcm9jZXNzLmV4aXQoMCk7XG59XG5hcHAub24oJ3NlY29uZC1pbnN0YW5jZScsIHJlc3RvcmVPckNyZWF0ZVdpbmRvdyk7XG5cbi8qKlxuICogRGlzYWJsZSBIYXJkd2FyZSBBY2NlbGVyYXRpb24gdG8gc2F2ZSBtb3JlIHN5c3RlbSByZXNvdXJjZXMuXG4gKi9cbmFwcC5kaXNhYmxlSGFyZHdhcmVBY2NlbGVyYXRpb24oKTtcblxuLyoqXG4gKiBTaG91dCBkb3duIGJhY2tncm91bmQgcHJvY2VzcyBpZiBhbGwgd2luZG93cyB3YXMgY2xvc2VkXG4gKi9cbmFwcC5vbignd2luZG93LWFsbC1jbG9zZWQnLCAoKSA9PiB7XG4gIGlmIChwcm9jZXNzLnBsYXRmb3JtICE9PSAnZGFyd2luJykge1xuICAgIGFwcC5xdWl0KCk7XG4gIH1cbn0pO1xuXG4vKipcbiAqIEBzZWUgaHR0cHM6Ly93d3cuZWxlY3Ryb25qcy5vcmcvZG9jcy9sYXRlc3QvYXBpL2FwcCNldmVudC1hY3RpdmF0ZS1tYWNvcyBFdmVudDogJ2FjdGl2YXRlJy5cbiAqL1xuYXBwLm9uKCdhY3RpdmF0ZScsIHJlc3RvcmVPckNyZWF0ZVdpbmRvdyk7XG5cbi8qKlxuICogQ3JlYXRlIHRoZSBhcHBsaWNhdGlvbiB3aW5kb3cgd2hlbiB0aGUgYmFja2dyb3VuZCBwcm9jZXNzIGlzIHJlYWR5LlxuICovXG5hcHBcbiAgLndoZW5SZWFkeSgpXG4gIC50aGVuKHJlc3RvcmVPckNyZWF0ZVdpbmRvdylcbiAgLmNhdGNoKGUgPT4gY29uc29sZS5lcnJvcignRmFpbGVkIGNyZWF0ZSB3aW5kb3c6JywgZSkpO1xuXG4vKipcbiAqIEluc3RhbGwgVnVlLmpzIG9yIGFueSBvdGhlciBleHRlbnNpb24gaW4gZGV2ZWxvcG1lbnQgbW9kZSBvbmx5LlxuICogTm90ZTogWW91IG11c3QgaW5zdGFsbCBgZWxlY3Ryb24tZGV2dG9vbHMtaW5zdGFsbGVyYCBtYW51YWxseVxuICovXG4vLyBpZiAoaW1wb3J0Lm1ldGEuZW52LkRFVikge1xuLy8gICBhcHAud2hlblJlYWR5KClcbi8vICAgICAudGhlbigoKSA9PiBpbXBvcnQoJ2VsZWN0cm9uLWRldnRvb2xzLWluc3RhbGxlcicpKVxuLy8gICAgIC50aGVuKCh7ZGVmYXVsdDogaW5zdGFsbEV4dGVuc2lvbiwgVlVFSlMzX0RFVlRPT0xTfSkgPT4gaW5zdGFsbEV4dGVuc2lvbihWVUVKUzNfREVWVE9PTFMsIHtcbi8vICAgICAgIGxvYWRFeHRlbnNpb25PcHRpb25zOiB7XG4vLyAgICAgICAgIGFsbG93RmlsZUFjY2VzczogdHJ1ZSxcbi8vICAgICAgIH0sXG4vLyAgICAgfSkpXG4vLyAgICAgLmNhdGNoKGUgPT4gY29uc29sZS5lcnJvcignRmFpbGVkIGluc3RhbGwgZXh0ZW5zaW9uOicsIGUpKTtcbi8vIH1cblxuLyoqXG4gKiBDaGVjayBmb3IgbmV3IHZlcnNpb24gb2YgdGhlIGFwcGxpY2F0aW9uIC0gcHJvZHVjdGlvbiBtb2RlIG9ubHkuXG4gKi9cbmlmIChpbXBvcnQubWV0YS5lbnYuUFJPRCkge1xuICBhcHBcbiAgICAud2hlblJlYWR5KClcbiAgICAudGhlbigoKSA9PiBpbXBvcnQoJ2VsZWN0cm9uLXVwZGF0ZXInKSlcbiAgICAudGhlbigoe2F1dG9VcGRhdGVyfSkgPT4gYXV0b1VwZGF0ZXIuY2hlY2tGb3JVcGRhdGVzQW5kTm90aWZ5KCkpXG4gICAgLmNhdGNoKGUgPT4gY29uc29sZS5lcnJvcignRmFpbGVkIGNoZWNrIHVwZGF0ZXM6JywgZSkpO1xufVxuIl0sIm5hbWVzIjpbIkJyb3dzZXJXaW5kb3ciLCJqb2luIiwiYXBwIiwiaXBjTWFpbiIsImRpYWxvZyIsInBhdGgiLCJmcyIsIlN0b3JlIiwidXJsIiwiVVJMIiwic2ltcGxlR2l0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFJQSxlQUFlLGVBQWU7QUFDdEIsUUFBQSxnQkFBZ0IsSUFBSUEsdUJBQWM7QUFBQSxJQUN0QyxNQUFNO0FBQUEsSUFDTixnQkFBZ0I7QUFBQSxNQUNkLFNBQVNDLEtBQUFBLEtBQUtDLFNBQUFBLElBQUksV0FBQSxHQUFjLGlDQUFpQztBQUFBLElBQ25FO0FBQUEsRUFBQSxDQUNEO0FBVWEsZ0JBQUEsR0FBRyxpQkFBaUIsTUFBTTtBQUN0QyxtREFBZTtBQUVVO0FBQ3ZCLHFEQUFlLFlBQVk7QUFBQSxJQUM3QjtBQUFBLEVBQUEsQ0FDRDtBQU9ELFFBQU0sVUFFQTtBQUdBLFFBQUEsY0FBYyxRQUFRLE9BQU87QUFFNUIsU0FBQTtBQUNUO0FBS0EsZUFBc0Isd0JBQXdCO0FBQ3hDLE1BQUEsU0FBU0YsdUJBQWMsZ0JBQWdCLEtBQUssQ0FBSyxNQUFBLENBQUMsRUFBRSxZQUFBLENBQWE7QUFFckUsTUFBSSxXQUFXLFFBQVc7QUFDeEIsYUFB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
