"use strict";
const electron = require("electron");
const path = require("path");
const url = require("url");
const Store = require("electron-store");
const fs = require("fs-extra");
const simpleGit = require("simple-git");
const _interopDefaultLegacy = (e) => e && typeof e === "object" && "default" in e ? e : { default: e };
const path__default = /* @__PURE__ */ _interopDefaultLegacy(path);
const Store__default = /* @__PURE__ */ _interopDefaultLegacy(Store);
const fs__default = /* @__PURE__ */ _interopDefaultLegacy(fs);
const simpleGit__default = /* @__PURE__ */ _interopDefaultLegacy(simpleGit);
async function createWindow() {
  const browserWindow = new electron.BrowserWindow({
    show: false,
    webPreferences: {
      preload: path.join(electron.app.getAppPath(), "packages/preload/dist/index.cjs")
    }
  });
  browserWindow.on("ready-to-show", () => {
    browserWindow == null ? void 0 : browserWindow.show();
    {
      browserWindow == null ? void 0 : browserWindow.webContents.openDevTools();
    }
  });
  const pageUrl = "http://localhost:5173/";
  await browserWindow.loadURL(pageUrl);
  return browserWindow;
}
async function restoreOrCreateWindow() {
  let window = electron.BrowserWindow.getAllWindows().find((w) => !w.isDestroyed());
  if (window === void 0) {
    window = await createWindow();
  }
  if (window.isMinimized()) {
    window.restore();
  }
  window.focus();
}
const channel = {
  app: {
    getPath: "getPath"
  },
  dialog: "dialog",
  path: {
    resolve: "resolve",
    join: "join",
    sep: "sep"
  },
  fs: {
    existsSync: "existsSync",
    removeSync: "removeSync",
    emptyDirSync: "emptyDirSync"
  },
  store: {
    get: "get",
    set: "set"
  },
  git: {
    repositoryAuthUrl: "repositoryAuthUrl",
    branchSummary: "branchSummary",
    logResult: "logResult"
  }
};
const appTitle = "Git Log Extract";
electron.ipcMain.handle(channel.dialog, async (event, options) => {
  return await electron.dialog.showOpenDialog(options);
});
electron.ipcMain.on(
  channel.app.getPath,
  async (event, ...args) => {
    event.returnValue = electron.app.getPath(...args);
  }
);
electron.ipcMain.on(
  channel.path.resolve,
  async (event, ...args) => {
    event.returnValue = path__default.default.resolve(...args);
  }
);
electron.ipcMain.on(channel.path.join, async (event, ...args) => {
  event.returnValue = path__default.default.join(...args);
});
electron.ipcMain.on(channel.path.sep, async (event) => {
  event.returnValue = path__default.default.sep;
});
electron.ipcMain.on(
  channel.fs.existsSync,
  async (event, ...args) => {
    event.returnValue = fs__default.default.existsSync(...args);
  }
);
electron.ipcMain.on(
  channel.fs.removeSync,
  async (event, ...args) => {
    event.returnValue = fs__default.default.removeSync(...args);
  }
);
electron.ipcMain.on(
  channel.fs.emptyDirSync,
  async (event, ...args) => {
    event.returnValue = fs__default.default.emptyDirSync(...args);
  }
);
const store = new Store__default.default({
  name: "git-log-extract-main-config",
  cwd: path__default.default.join(electron.app.getPath("appData"), appTitle)
});
electron.ipcMain.on(channel.store.set, async (event, ...args) => {
  store.set(...args);
});
electron.ipcMain.on(channel.store.get, async (event, key, defaultValue) => {
  event.returnValue = store.get(key, defaultValue);
});
electron.ipcMain.handle(
  channel.git.repositoryAuthUrl,
  async (event, url$1, username, password) => {
    const urlObj = new url.URL(url$1);
    urlObj.username = username;
    urlObj.password = password;
    return urlObj.href;
  }
);
function createGit(options, onProgress) {
  if (typeof options === "undefined") {
    options = { baseDir: "" };
  }
  const git = simpleGit__default.default(options);
  git.outputHandler((bin, stdout, stderr, args) => {
    stdout.pipe(process.stdout);
    stderr.pipe(process.stderr);
    stderr.on("data", function(stdData) {
      if (onProgress) {
        onProgress(stdData.toString());
      }
    });
  });
  return git;
}
electron.ipcMain.handle(
  channel.git.branchSummary,
  async (event, directoryPath, repositoryAuthUrl) => {
    const git = createGit({
      baseDir: directoryPath
    });
    await git.init();
    await git.addRemote("origin", repositoryAuthUrl);
    await git.fetch(['--shallow-since="1 months ago"']);
    const branchSummary = await git.branch(["-r"]);
    return branchSummary;
  }
);
electron.ipcMain.handle(
  channel.git.logResult,
  async (event, directoryPath, logOptions) => {
    const git = createGit({ baseDir: directoryPath });
    await git.fetch(['--shallow-since="1 months ago"']);
    const logResult = await git.log(logOptions);
    return logResult;
  }
);
const isSingleInstance = electron.app.requestSingleInstanceLock();
if (!isSingleInstance) {
  electron.app.quit();
  process.exit(0);
}
electron.app.on("second-instance", restoreOrCreateWindow);
electron.app.disableHardwareAcceleration();
electron.app.on("window-all-closed", () => {
  if (process.platform !== "darwin") {
    electron.app.quit();
  }
});
electron.app.on("activate", restoreOrCreateWindow);
electron.app.whenReady().then(restoreOrCreateWindow).catch((e) => console.error("Failed create window:", e));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguY2pzIiwic291cmNlcyI6WyIuLi9zcmMvbWFpbldpbmRvdy50cyIsIi4uLy4uL2NvbW1vbi9zcmMvY2hhbm5lbC50cyIsIi4uL3NyYy9saXN0ZW5lci50cyIsIi4uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2FwcCwgQnJvd3NlcldpbmRvd30gZnJvbSAnZWxlY3Ryb24nO1xuaW1wb3J0IHtqb2lufSBmcm9tICdwYXRoJztcbmltcG9ydCB7VVJMfSBmcm9tICd1cmwnO1xuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVXaW5kb3coKSB7XG4gIGNvbnN0IGJyb3dzZXJXaW5kb3cgPSBuZXcgQnJvd3NlcldpbmRvdyh7XG4gICAgc2hvdzogZmFsc2UsIC8vIFVzZSB0aGUgJ3JlYWR5LXRvLXNob3cnIGV2ZW50IHRvIHNob3cgdGhlIGluc3RhbnRpYXRlZCBCcm93c2VyV2luZG93LlxuICAgIHdlYlByZWZlcmVuY2VzOiB7XG4gICAgICBwcmVsb2FkOiBqb2luKGFwcC5nZXRBcHBQYXRoKCksICdwYWNrYWdlcy9wcmVsb2FkL2Rpc3QvaW5kZXguY2pzJyksXG4gICAgfSxcbiAgfSk7XG5cbiAgLyoqXG4gICAqIElmIHRoZSAnc2hvdycgcHJvcGVydHkgb2YgdGhlIEJyb3dzZXJXaW5kb3cncyBjb25zdHJ1Y3RvciBpcyBvbWl0dGVkIGZyb20gdGhlIGluaXRpYWxpemF0aW9uIG9wdGlvbnMsXG4gICAqIGl0IHRoZW4gZGVmYXVsdHMgdG8gJ3RydWUnLiBUaGlzIGNhbiBjYXVzZSBmbGlja2VyaW5nIGFzIHRoZSB3aW5kb3cgbG9hZHMgdGhlIGh0bWwgY29udGVudCxcbiAgICogYW5kIGl0IGFsc28gaGFzIHNob3cgcHJvYmxlbWF0aWMgYmVoYXZpb3VyIHdpdGggdGhlIGNsb3Npbmcgb2YgdGhlIHdpbmRvdy5cbiAgICogVXNlIGBzaG93OiBmYWxzZWAgYW5kIGxpc3RlbiB0byB0aGUgIGByZWFkeS10by1zaG93YCBldmVudCB0byBzaG93IHRoZSB3aW5kb3cuXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2VsZWN0cm9uL2VsZWN0cm9uL2lzc3Vlcy8yNTAxMiBmb3IgdGhlIGFmZm9yZCBtZW50aW9uZWQgaXNzdWUuXG4gICAqL1xuICBicm93c2VyV2luZG93Lm9uKCdyZWFkeS10by1zaG93JywgKCkgPT4ge1xuICAgIGJyb3dzZXJXaW5kb3c/LnNob3coKTtcblxuICAgIGlmIChpbXBvcnQubWV0YS5lbnYuREVWKSB7XG4gICAgICBicm93c2VyV2luZG93Py53ZWJDb250ZW50cy5vcGVuRGV2VG9vbHMoKTtcbiAgICB9XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBVUkwgZm9yIG1haW4gd2luZG93LlxuICAgKiBWaXRlIGRldiBzZXJ2ZXIgZm9yIGRldmVsb3BtZW50LlxuICAgKiBgZmlsZTovLy4uL3JlbmRlcmVyL2luZGV4Lmh0bWxgIGZvciBwcm9kdWN0aW9uIGFuZCB0ZXN0LlxuICAgKi9cbiAgY29uc3QgcGFnZVVybCA9XG4gICAgaW1wb3J0Lm1ldGEuZW52LkRFViAmJiBpbXBvcnQubWV0YS5lbnYuVklURV9ERVZfU0VSVkVSX1VSTCAhPT0gdW5kZWZpbmVkXG4gICAgICA/IGltcG9ydC5tZXRhLmVudi5WSVRFX0RFVl9TRVJWRVJfVVJMXG4gICAgICA6IG5ldyBVUkwoJy4uL3JlbmRlcmVyL2Rpc3QvaW5kZXguaHRtbCcsICdmaWxlOi8vJyArIF9fZGlybmFtZSkudG9TdHJpbmcoKTtcblxuICBhd2FpdCBicm93c2VyV2luZG93LmxvYWRVUkwocGFnZVVybCk7XG5cbiAgcmV0dXJuIGJyb3dzZXJXaW5kb3c7XG59XG5cbi8qKlxuICogUmVzdG9yZSBhbiBleGlzdGluZyBCcm93c2VyV2luZG93IG9yIENyZWF0ZSBhIG5ldyBCcm93c2VyV2luZG93LlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVzdG9yZU9yQ3JlYXRlV2luZG93KCkge1xuICBsZXQgd2luZG93ID0gQnJvd3NlcldpbmRvdy5nZXRBbGxXaW5kb3dzKCkuZmluZCh3ID0+ICF3LmlzRGVzdHJveWVkKCkpO1xuXG4gIGlmICh3aW5kb3cgPT09IHVuZGVmaW5lZCkge1xuICAgIHdpbmRvdyA9IGF3YWl0IGNyZWF0ZVdpbmRvdygpO1xuICB9XG5cbiAgaWYgKHdpbmRvdy5pc01pbmltaXplZCgpKSB7XG4gICAgd2luZG93LnJlc3RvcmUoKTtcbiAgfVxuXG4gIHdpbmRvdy5mb2N1cygpO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQge1xuICBhcHA6IHtcbiAgICBnZXRQYXRoOiAnZ2V0UGF0aCcsXG4gIH0sXG4gIGRpYWxvZzogJ2RpYWxvZycsXG4gIHBhdGg6IHtcbiAgICByZXNvbHZlOiAncmVzb2x2ZScsXG4gICAgam9pbjogJ2pvaW4nLFxuICAgIHNlcDogJ3NlcCcsXG4gIH0sXG4gIGZzOiB7XG4gICAgZXhpc3RzU3luYzogJ2V4aXN0c1N5bmMnLFxuICAgIHJlbW92ZVN5bmM6ICdyZW1vdmVTeW5jJyxcbiAgICBlbXB0eURpclN5bmM6ICdlbXB0eURpclN5bmMnLFxuICB9LFxuICBzdG9yZToge1xuICAgIGdldDogJ2dldCcsXG4gICAgc2V0OiAnc2V0JyxcbiAgfSxcbiAgZ2l0OiB7XG4gICAgcmVwb3NpdG9yeUF1dGhVcmw6ICdyZXBvc2l0b3J5QXV0aFVybCcsXG4gICAgYnJhbmNoU3VtbWFyeTogJ2JyYW5jaFN1bW1hcnknLFxuICAgIGxvZ1Jlc3VsdDogJ2xvZ1Jlc3VsdCcsXG4gIH0sXG59O1xuIiwiaW1wb3J0IHR5cGUge1dpbmRvd0VsZWN0cm9uUGFyYW1ldGVyc30gZnJvbSAnKi52dWV8dHN8dHN4JztcbmltcG9ydCBjaGFubmVsIGZyb20gJ0AvY29tbW9uL2NoYW5uZWwnO1xuaW1wb3J0IHthcHBUaXRsZX0gZnJvbSAnQC9jb21tb24vaW5kZXguanNvbic7XG5pbXBvcnQgdHlwZSB7T3BlbkRpYWxvZ09wdGlvbnN9IGZyb20gJ2VsZWN0cm9uJztcbmltcG9ydCB7YXBwLCBkaWFsb2csIGlwY01haW59IGZyb20gJ2VsZWN0cm9uJztcbmltcG9ydCBTdG9yZSBmcm9tICdlbGVjdHJvbi1zdG9yZSc7XG5pbXBvcnQgZnMgZnJvbSAnZnMtZXh0cmEnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgdHlwZSB7QnJhbmNoU3VtbWFyeSwgTG9nUmVzdWx0LCBTaW1wbGVHaXRPcHRpb25zfSBmcm9tICdzaW1wbGUtZ2l0JztcbmltcG9ydCBzaW1wbGVHaXQgZnJvbSAnc2ltcGxlLWdpdCc7XG5pbXBvcnQge1VSTH0gZnJvbSAndXJsJztcbi8vXG4vLyBpcGNNYWluLmhhbmRsZSgnZWxlY3Ryb25FeGFtcGxlSGFuZGxlJywgYXN5bmMgKGV2ZW50LCAuLi5hcmdzKSA9PiB7fSk7XG4vLyBpcGNNYWluLm9uKCdlbGVjdHJvbkV4YW1wbGVPbicsIGFzeW5jIChldmVudCwgLi4uYXJncykgPT4ge1xuLy8gICBldmVudC5yZXR1cm5WYWx1ZSA9ICcnO1xuLy8gfSk7XG5cbi8vIGVsZWN0cm9uIHN0YXJ0XG5pcGNNYWluLmhhbmRsZShjaGFubmVsLmRpYWxvZywgYXN5bmMgKGV2ZW50LCBvcHRpb25zOiBPcGVuRGlhbG9nT3B0aW9ucykgPT4ge1xuICByZXR1cm4gYXdhaXQgZGlhbG9nLnNob3dPcGVuRGlhbG9nKG9wdGlvbnMpO1xufSk7XG5cbmlwY01haW4ub24oXG4gIGNoYW5uZWwuYXBwLmdldFBhdGgsXG4gIGFzeW5jIChldmVudCwgLi4uYXJnczogV2luZG93RWxlY3Ryb25QYXJhbWV0ZXJzWydhcHAnXVsnZ2V0UGF0aCddKSA9PiB7XG4gICAgZXZlbnQucmV0dXJuVmFsdWUgPSBhcHAuZ2V0UGF0aCguLi5hcmdzKTtcbiAgfSxcbik7XG4vLyBlbGVjdHJvbiBlbmRcblxuLy8gbm9kZSBzdGFydFxuaXBjTWFpbi5vbihcbiAgY2hhbm5lbC5wYXRoLnJlc29sdmUsXG4gIGFzeW5jIChldmVudCwgLi4uYXJnczogV2luZG93RWxlY3Ryb25QYXJhbWV0ZXJzWydwYXRoJ11bJ3Jlc29sdmUnXSkgPT4ge1xuICAgIGV2ZW50LnJldHVyblZhbHVlID0gcGF0aC5yZXNvbHZlKC4uLmFyZ3MpO1xuICB9LFxuKTtcblxuaXBjTWFpbi5vbihjaGFubmVsLnBhdGguam9pbiwgYXN5bmMgKGV2ZW50LCAuLi5hcmdzOiBXaW5kb3dFbGVjdHJvblBhcmFtZXRlcnNbJ3BhdGgnXVsnam9pbiddKSA9PiB7XG4gIGV2ZW50LnJldHVyblZhbHVlID0gcGF0aC5qb2luKC4uLmFyZ3MpO1xufSk7XG5cbmlwY01haW4ub24oY2hhbm5lbC5wYXRoLnNlcCwgYXN5bmMgZXZlbnQgPT4ge1xuICBldmVudC5yZXR1cm5WYWx1ZSA9IHBhdGguc2VwO1xufSk7XG5cbmlwY01haW4ub24oXG4gIGNoYW5uZWwuZnMuZXhpc3RzU3luYyxcbiAgYXN5bmMgKGV2ZW50LCAuLi5hcmdzOiBXaW5kb3dFbGVjdHJvblBhcmFtZXRlcnNbJ2ZzJ11bJ2V4aXN0c1N5bmMnXSkgPT4ge1xuICAgIGV2ZW50LnJldHVyblZhbHVlID0gZnMuZXhpc3RzU3luYyguLi5hcmdzKTtcbiAgfSxcbik7XG5cbmlwY01haW4ub24oXG4gIGNoYW5uZWwuZnMucmVtb3ZlU3luYyxcbiAgYXN5bmMgKGV2ZW50LCAuLi5hcmdzOiBXaW5kb3dFbGVjdHJvblBhcmFtZXRlcnNbJ2ZzJ11bJ3JlbW92ZVN5bmMnXSkgPT4ge1xuICAgIGV2ZW50LnJldHVyblZhbHVlID0gZnMucmVtb3ZlU3luYyguLi5hcmdzKTtcbiAgfSxcbik7XG5cbmlwY01haW4ub24oXG4gIGNoYW5uZWwuZnMuZW1wdHlEaXJTeW5jLFxuICBhc3luYyAoZXZlbnQsIC4uLmFyZ3M6IFdpbmRvd0VsZWN0cm9uUGFyYW1ldGVyc1snZnMnXVsnZW1wdHlEaXJTeW5jJ10pID0+IHtcbiAgICBldmVudC5yZXR1cm5WYWx1ZSA9IGZzLmVtcHR5RGlyU3luYyguLi5hcmdzKTtcbiAgfSxcbik7XG5cbi8vIG5vZGUgZW5kXG5cbmNvbnN0IHN0b3JlID0gbmV3IFN0b3JlKHtcbiAgbmFtZTogJ2dpdC1sb2ctZXh0cmFjdC1tYWluLWNvbmZpZycsXG4gIGN3ZDogcGF0aC5qb2luKGFwcC5nZXRQYXRoKCdhcHBEYXRhJyksIGFwcFRpdGxlKSxcbn0pO1xuXG5pcGNNYWluLm9uKGNoYW5uZWwuc3RvcmUuc2V0LCBhc3luYyAoZXZlbnQsIC4uLmFyZ3M6IFdpbmRvd0VsZWN0cm9uUGFyYW1ldGVyc1snc3RvcmUnXVsnc2V0J10pID0+IHtcbiAgc3RvcmUuc2V0KC4uLmFyZ3MpO1xufSk7XG5cbmlwY01haW4ub24oY2hhbm5lbC5zdG9yZS5nZXQsIGFzeW5jIChldmVudCwga2V5OiBzdHJpbmcsIGRlZmF1bHRWYWx1ZT86IHVua25vd24pID0+IHtcbiAgZXZlbnQucmV0dXJuVmFsdWUgPSBzdG9yZS5nZXQoa2V5LCBkZWZhdWx0VmFsdWUpO1xufSk7XG5cbmlwY01haW4uaGFuZGxlKFxuICBjaGFubmVsLmdpdC5yZXBvc2l0b3J5QXV0aFVybCxcbiAgYXN5bmMgKGV2ZW50LCB1cmw6IHN0cmluZywgdXNlcm5hbWU6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IHVybE9iaiA9IG5ldyBVUkwodXJsKTtcbiAgICB1cmxPYmoudXNlcm5hbWUgPSB1c2VybmFtZTtcbiAgICB1cmxPYmoucGFzc3dvcmQgPSBwYXNzd29yZDtcbiAgICByZXR1cm4gdXJsT2JqLmhyZWY7XG4gIH0sXG4pO1xuXG5mdW5jdGlvbiBjcmVhdGVHaXQob3B0aW9ucz86IFBhcnRpYWw8U2ltcGxlR2l0T3B0aW9ucz4sIG9uUHJvZ3Jlc3M/OiAoZGF0YTogc3RyaW5nKSA9PiB2b2lkKSB7XG4gIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBvcHRpb25zID0ge2Jhc2VEaXI6ICcnfTtcbiAgfVxuICAvLyBpZiAob25Qcm9ncmVzcykge1xuICAvLyAgIG9wdGlvbnMucHJvZ3Jlc3MgID0gKGRhdGE6IFNpbXBsZUdpdFByb2dyZXNzRXZlbnQpID0+IHtcbiAgLy8gICAgIGNvbnNvbGUubG9nKFxuICAvLyAgICAgICBgZ2l0LiR7ZGF0YS5tZXRob2R9ICR7ZGF0YS5zdGFnZX0gc3RhZ2UgJHtkYXRhLnByb2dyZXNzfSUgY29tcGxldGVgXG4gIC8vICAgICApO1xuICAvLyAgICAgb25Qcm9ncmVzcyhkYXRhKTtcbiAgLy8gICB9O1xuICAvLyB9XG4gIGNvbnN0IGdpdCA9IHNpbXBsZUdpdChvcHRpb25zKTtcblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gIGdpdC5vdXRwdXRIYW5kbGVyKChiaW4sIHN0ZG91dCwgc3RkZXJyLCBhcmdzKSA9PiB7XG4gICAgc3Rkb3V0LnBpcGUocHJvY2Vzcy5zdGRvdXQpO1xuICAgIHN0ZGVyci5waXBlKHByb2Nlc3Muc3RkZXJyKTtcbiAgICBzdGRlcnIub24oJ2RhdGEnLCBmdW5jdGlvbiAoc3RkRGF0YToge3RvU3RyaW5nOiAoKSA9PiBzdHJpbmd9KSB7XG4gICAgICAvLyBjb25zb2xlLmxvZyhzdGREYXRhLnRvU3RyaW5nKCkpO1xuICAgICAgaWYgKG9uUHJvZ3Jlc3MpIHtcbiAgICAgICAgb25Qcm9ncmVzcyhzdGREYXRhLnRvU3RyaW5nKCkpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbiAgcmV0dXJuIGdpdDtcbn1cblxuaXBjTWFpbi5oYW5kbGUoXG4gIGNoYW5uZWwuZ2l0LmJyYW5jaFN1bW1hcnksXG4gIGFzeW5jIChldmVudCwgZGlyZWN0b3J5UGF0aDogc3RyaW5nLCByZXBvc2l0b3J5QXV0aFVybDogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgZ2l0ID0gY3JlYXRlR2l0KHtcbiAgICAgIGJhc2VEaXI6IGRpcmVjdG9yeVBhdGgsXG4gICAgfSk7XG4gICAgYXdhaXQgZ2l0LmluaXQoKTtcbiAgICBhd2FpdCBnaXQuYWRkUmVtb3RlKCdvcmlnaW4nLCByZXBvc2l0b3J5QXV0aFVybCk7XG4gICAgYXdhaXQgZ2l0LmZldGNoKFsnLS1zaGFsbG93LXNpbmNlPVwiMSBtb250aHMgYWdvXCInXSk7XG4gICAgLy8gYXdhaXQgZ2l0LnJlbW90ZShbXCJ1cGRhdGVcIl0pO1xuICAgIGNvbnN0IGJyYW5jaFN1bW1hcnk6IEJyYW5jaFN1bW1hcnkgPSBhd2FpdCBnaXQuYnJhbmNoKFsnLXInXSk7XG4gICAgcmV0dXJuIGJyYW5jaFN1bW1hcnk7XG4gIH0sXG4pO1xuXG5pcGNNYWluLmhhbmRsZShcbiAgY2hhbm5lbC5naXQubG9nUmVzdWx0LFxuICBhc3luYyAoZXZlbnQsIGRpcmVjdG9yeVBhdGg6IHN0cmluZywgbG9nT3B0aW9uczogc3RyaW5nW10pID0+IHtcbiAgICBjb25zdCBnaXQgPSBjcmVhdGVHaXQoe2Jhc2VEaXI6IGRpcmVjdG9yeVBhdGh9KTtcbiAgICBhd2FpdCBnaXQuZmV0Y2goWyctLXNoYWxsb3ctc2luY2U9XCIxIG1vbnRocyBhZ29cIiddKTtcbiAgICAvLyBjb25zb2xlLmxvZygnZ2l0IDEnKTtcbiAgICAvLyBhd2FpdCBnaXQucmVtb3RlKFtcInVwZGF0ZVwiXSk7XG4gICAgLy8gLy8gY29uc29sZS5sb2coJ2dpdCAyJyk7XG4gICAgY29uc3QgbG9nUmVzdWx0OiBMb2dSZXN1bHQgPSBhd2FpdCBnaXQubG9nKGxvZ09wdGlvbnMpO1xuICAgIC8vIGNvbnNvbGUubG9nKCdnaXQgMycpO1xuICAgIHJldHVybiBsb2dSZXN1bHQ7XG4gIH0sXG4pO1xuIiwiaW1wb3J0IHtyZXN0b3JlT3JDcmVhdGVXaW5kb3d9IGZyb20gJ0AvbWFpbi9tYWluV2luZG93JztcbmltcG9ydCB7YXBwfSBmcm9tICdlbGVjdHJvbic7XG5pbXBvcnQgJy4vbGlzdGVuZXInO1xuLyoqXG4gKiBQcmV2ZW50IGVsZWN0cm9uIGZyb20gcnVubmluZyBtdWx0aXBsZSBpbnN0YW5jZXMuXG4gKi9cbmNvbnN0IGlzU2luZ2xlSW5zdGFuY2UgPSBhcHAucmVxdWVzdFNpbmdsZUluc3RhbmNlTG9jaygpO1xuaWYgKCFpc1NpbmdsZUluc3RhbmNlKSB7XG4gIGFwcC5xdWl0KCk7XG4gIHByb2Nlc3MuZXhpdCgwKTtcbn1cbmFwcC5vbignc2Vjb25kLWluc3RhbmNlJywgcmVzdG9yZU9yQ3JlYXRlV2luZG93KTtcblxuLyoqXG4gKiBEaXNhYmxlIEhhcmR3YXJlIEFjY2VsZXJhdGlvbiB0byBzYXZlIG1vcmUgc3lzdGVtIHJlc291cmNlcy5cbiAqL1xuYXBwLmRpc2FibGVIYXJkd2FyZUFjY2VsZXJhdGlvbigpO1xuXG4vKipcbiAqIFNob3V0IGRvd24gYmFja2dyb3VuZCBwcm9jZXNzIGlmIGFsbCB3aW5kb3dzIHdhcyBjbG9zZWRcbiAqL1xuYXBwLm9uKCd3aW5kb3ctYWxsLWNsb3NlZCcsICgpID0+IHtcbiAgaWYgKHByb2Nlc3MucGxhdGZvcm0gIT09ICdkYXJ3aW4nKSB7XG4gICAgYXBwLnF1aXQoKTtcbiAgfVxufSk7XG5cbi8qKlxuICogQHNlZSBodHRwczovL3d3dy5lbGVjdHJvbmpzLm9yZy9kb2NzL2xhdGVzdC9hcGkvYXBwI2V2ZW50LWFjdGl2YXRlLW1hY29zIEV2ZW50OiAnYWN0aXZhdGUnLlxuICovXG5hcHAub24oJ2FjdGl2YXRlJywgcmVzdG9yZU9yQ3JlYXRlV2luZG93KTtcblxuLyoqXG4gKiBDcmVhdGUgdGhlIGFwcGxpY2F0aW9uIHdpbmRvdyB3aGVuIHRoZSBiYWNrZ3JvdW5kIHByb2Nlc3MgaXMgcmVhZHkuXG4gKi9cbmFwcFxuICAud2hlblJlYWR5KClcbiAgLnRoZW4ocmVzdG9yZU9yQ3JlYXRlV2luZG93KVxuICAuY2F0Y2goZSA9PiBjb25zb2xlLmVycm9yKCdGYWlsZWQgY3JlYXRlIHdpbmRvdzonLCBlKSk7XG5cbi8qKlxuICogSW5zdGFsbCBWdWUuanMgb3IgYW55IG90aGVyIGV4dGVuc2lvbiBpbiBkZXZlbG9wbWVudCBtb2RlIG9ubHkuXG4gKiBOb3RlOiBZb3UgbXVzdCBpbnN0YWxsIGBlbGVjdHJvbi1kZXZ0b29scy1pbnN0YWxsZXJgIG1hbnVhbGx5XG4gKi9cbi8vIGlmIChpbXBvcnQubWV0YS5lbnYuREVWKSB7XG4vLyAgIGFwcC53aGVuUmVhZHkoKVxuLy8gICAgIC50aGVuKCgpID0+IGltcG9ydCgnZWxlY3Ryb24tZGV2dG9vbHMtaW5zdGFsbGVyJykpXG4vLyAgICAgLnRoZW4oKHtkZWZhdWx0OiBpbnN0YWxsRXh0ZW5zaW9uLCBWVUVKUzNfREVWVE9PTFN9KSA9PiBpbnN0YWxsRXh0ZW5zaW9uKFZVRUpTM19ERVZUT09MUywge1xuLy8gICAgICAgbG9hZEV4dGVuc2lvbk9wdGlvbnM6IHtcbi8vICAgICAgICAgYWxsb3dGaWxlQWNjZXNzOiB0cnVlLFxuLy8gICAgICAgfSxcbi8vICAgICB9KSlcbi8vICAgICAuY2F0Y2goZSA9PiBjb25zb2xlLmVycm9yKCdGYWlsZWQgaW5zdGFsbCBleHRlbnNpb246JywgZSkpO1xuLy8gfVxuXG4vKipcbiAqIENoZWNrIGZvciBuZXcgdmVyc2lvbiBvZiB0aGUgYXBwbGljYXRpb24gLSBwcm9kdWN0aW9uIG1vZGUgb25seS5cbiAqL1xuaWYgKGltcG9ydC5tZXRhLmVudi5QUk9EKSB7XG4gIGFwcFxuICAgIC53aGVuUmVhZHkoKVxuICAgIC50aGVuKCgpID0+IGltcG9ydCgnZWxlY3Ryb24tdXBkYXRlcicpKVxuICAgIC50aGVuKCh7YXV0b1VwZGF0ZXJ9KSA9PiBhdXRvVXBkYXRlci5jaGVja0ZvclVwZGF0ZXNBbmROb3RpZnkoKSlcbiAgICAuY2F0Y2goZSA9PiBjb25zb2xlLmVycm9yKCdGYWlsZWQgY2hlY2sgdXBkYXRlczonLCBlKSk7XG59XG4iXSwibmFtZXMiOlsiQnJvd3NlcldpbmRvdyIsImpvaW4iLCJhcHAiLCJpcGNNYWluIiwiZGlhbG9nIiwicGF0aCIsImZzIiwiU3RvcmUiLCJ1cmwiLCJVUkwiLCJzaW1wbGVHaXQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUlBLGVBQWUsZUFBZTtBQUN0QixRQUFBLGdCQUFnQixJQUFJQSx1QkFBYztBQUFBLElBQ3RDLE1BQU07QUFBQSxJQUNOLGdCQUFnQjtBQUFBLE1BQ2QsU0FBU0MsS0FBQUEsS0FBS0MsU0FBQUEsSUFBSSxXQUFBLEdBQWMsaUNBQWlDO0FBQUEs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
