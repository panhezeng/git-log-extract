"use strict";
const electron = require("electron");
const path = require("path");
const url = require("url");
const Store = require("electron-store");
const fs = require("fs-extra");
const simpleGit = require("simple-git");
const _interopDefaultLegacy = (e) => e && typeof e === "object" && "default" in e ? e : { default: e };
const path__default = /* @__PURE__ */ _interopDefaultLegacy(path);
const Store__default = /* @__PURE__ */ _interopDefaultLegacy(Store);
const fs__default = /* @__PURE__ */ _interopDefaultLegacy(fs);
const simpleGit__default = /* @__PURE__ */ _interopDefaultLegacy(simpleGit);
async function createWindow() {
  const browserWindow = new electron.BrowserWindow({
    show: false,
    webPreferences: {
      preload: path.join(electron.app.getAppPath(), "packages/preload/dist/index.cjs")
    }
  });
  browserWindow.on("ready-to-show", () => {
    browserWindow == null ? void 0 : browserWindow.show();
    {
      browserWindow == null ? void 0 : browserWindow.webContents.openDevTools();
    }
  });
  const pageUrl = "http://localhost:5174/";
  await browserWindow.loadURL(pageUrl);
  return browserWindow;
}
let window = void 0;
async function restoreOrCreateWindow() {
  window = electron.BrowserWindow.getAllWindows().find((w) => !w.isDestroyed());
  if (window === void 0) {
    window = await createWindow();
  }
  if (window.isMinimized()) {
    window.restore();
  }
  window.focus();
}
const channel = {
  app: {
    getPath: "app.getPath"
  },
  dialog: "dialog",
  path: {
    resolve: "path.resolve",
    join: "path.join",
    sep: "path.sep"
  },
  fs: {
    existsSync: "fs.existsSync",
    removeSync: "fs.removeSync",
    emptyDirSync: "fs.emptyDirSync"
  },
  store: {
    get: "store.get",
    set: "store.set"
  },
  git: {
    repositoryAuthUrl: "git.repositoryAuthUrl",
    branchSummary: "git.branchSummary",
    logResult: "git.logResult"
  }
};
const appTitle = "Git Log Extract";
electron.ipcMain.handle(channel.dialog, async (event, options) => {
  return await electron.dialog.showOpenDialog(options);
});
electron.ipcMain.on(
  channel.app.getPath,
  async (event, ...args) => {
    event.returnValue = electron.app.getPath(...args);
  }
);
electron.ipcMain.on(
  channel.path.resolve,
  async (event, ...args) => {
    event.returnValue = path__default.default.resolve(...args);
  }
);
electron.ipcMain.on(channel.path.join, async (event, ...args) => {
  event.returnValue = path__default.default.join(...args);
});
electron.ipcMain.on(channel.path.sep, async (event) => {
  event.returnValue = path__default.default.sep;
});
electron.ipcMain.on(
  channel.fs.existsSync,
  async (event, ...args) => {
    event.returnValue = fs__default.default.existsSync(...args);
  }
);
electron.ipcMain.on(
  channel.fs.removeSync,
  async (event, ...args) => {
    event.returnValue = fs__default.default.removeSync(...args);
  }
);
electron.ipcMain.on(
  channel.fs.emptyDirSync,
  async (event, ...args) => {
    event.returnValue = fs__default.default.emptyDirSync(...args);
  }
);
const store = new Store__default.default({
  name: "git-log-extract-main-config",
  cwd: path__default.default.join(electron.app.getPath("appData"), appTitle)
});
electron.ipcMain.on(channel.store.set, async (event, ...args) => {
  store.set(...args);
});
electron.ipcMain.on(channel.store.get, async (event, key, defaultValue) => {
  event.returnValue = store.get(key, defaultValue);
});
electron.ipcMain.handle(
  channel.git.repositoryAuthUrl,
  async (event, url$1, username, password) => {
    const urlObj = new url.URL(url$1);
    urlObj.username = username;
    urlObj.password = password;
    return urlObj.href;
  }
);
function createGit(options, onProgress) {
  if (typeof options === "undefined") {
    options = { baseDir: "" };
  }
  const git = simpleGit__default.default(options);
  git.outputHandler((bin, stdout, stderr, args) => {
    stdout.pipe(process.stdout);
    stderr.pipe(process.stderr);
    stderr.on("data", function(stdData) {
      if (onProgress) {
        onProgress(stdData.toString());
      }
    });
  });
  return git;
}
electron.ipcMain.handle(
  channel.git.branchSummary,
  async (event, directoryPath, repositoryAuthUrl) => {
    const git = createGit({
      baseDir: directoryPath
    });
    await git.init();
    await git.addRemote("origin", repositoryAuthUrl);
    await git.fetch(['--shallow-since="1 months ago"']);
    const branchSummary = await git.branch(["-r"]);
    return branchSummary;
  }
);
electron.ipcMain.handle(
  channel.git.logResult,
  async (event, directoryPath, logOptions) => {
    const git = createGit({ baseDir: directoryPath });
    await git.fetch(['--shallow-since="1 months ago"']);
    const logResult = await git.log(logOptions);
    return logResult;
  }
);
const isSingleInstance = electron.app.requestSingleInstanceLock();
if (!isSingleInstance) {
  electron.app.quit();
  process.exit(0);
}
electron.app.on("second-instance", restoreOrCreateWindow);
electron.app.disableHardwareAcceleration();
electron.app.on("window-all-closed", () => {
  if (process.platform !== "darwin") {
    electron.app.quit();
  }
});
electron.app.on("activate", restoreOrCreateWindow);
electron.app.whenReady().then(restoreOrCreateWindow).catch((e) => console.error("Failed create window:", e));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguY2pzIiwic291cmNlcyI6WyIuLi9zcmMvbWFpbldpbmRvdy50cyIsIi4uLy4uL2NvbW1vbi9zcmMvY2hhbm5lbC50cyIsIi4uL3NyYy9pcGNNYWluTGlzdGVuZXIudHMiLCIuLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHthcHAsIEJyb3dzZXJXaW5kb3d9IGZyb20gJ2VsZWN0cm9uJztcbmltcG9ydCB7am9pbn0gZnJvbSAncGF0aCc7XG5pbXBvcnQge1VSTH0gZnJvbSAndXJsJztcblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlV2luZG93KCkge1xuICBjb25zdCBicm93c2VyV2luZG93ID0gbmV3IEJyb3dzZXJXaW5kb3coe1xuICAgIHNob3c6IGZhbHNlLCAvLyBVc2UgdGhlICdyZWFkeS10by1zaG93JyBldmVudCB0byBzaG93IHRoZSBpbnN0YW50aWF0ZWQgQnJvd3NlcldpbmRvdy5cbiAgICB3ZWJQcmVmZXJlbmNlczoge1xuICAgICAgcHJlbG9hZDogam9pbihhcHAuZ2V0QXBwUGF0aCgpLCAncGFja2FnZXMvcHJlbG9hZC9kaXN0L2luZGV4LmNqcycpLFxuICAgIH0sXG4gIH0pO1xuXG4gIC8qKlxuICAgKiBJZiB0aGUgJ3Nob3cnIHByb3BlcnR5IG9mIHRoZSBCcm93c2VyV2luZG93J3MgY29uc3RydWN0b3IgaXMgb21pdHRlZCBmcm9tIHRoZSBpbml0aWFsaXphdGlvbiBvcHRpb25zLFxuICAgKiBpdCB0aGVuIGRlZmF1bHRzIHRvICd0cnVlJy4gVGhpcyBjYW4gY2F1c2UgZmxpY2tlcmluZyBhcyB0aGUgd2luZG93IGxvYWRzIHRoZSBodG1sIGNvbnRlbnQsXG4gICAqIGFuZCBpdCBhbHNvIGhhcyBzaG93IHByb2JsZW1hdGljIGJlaGF2aW91ciB3aXRoIHRoZSBjbG9zaW5nIG9mIHRoZSB3aW5kb3cuXG4gICAqIFVzZSBgc2hvdzogZmFsc2VgIGFuZCBsaXN0ZW4gdG8gdGhlICBgcmVhZHktdG8tc2hvd2AgZXZlbnQgdG8gc2hvdyB0aGUgd2luZG93LlxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9lbGVjdHJvbi9lbGVjdHJvbi9pc3N1ZXMvMjUwMTIgZm9yIHRoZSBhZmZvcmQgbWVudGlvbmVkIGlzc3VlLlxuICAgKi9cbiAgYnJvd3NlcldpbmRvdy5vbigncmVhZHktdG8tc2hvdycsICgpID0+IHtcbiAgICBicm93c2VyV2luZG93Py5zaG93KCk7XG5cbiAgICBpZiAoaW1wb3J0Lm1ldGEuZW52LkRFVikge1xuICAgICAgYnJvd3NlcldpbmRvdz8ud2ViQ29udGVudHMub3BlbkRldlRvb2xzKCk7XG4gICAgfVxuICB9KTtcblxuICAvKipcbiAgICogVVJMIGZvciBtYWluIHdpbmRvdy5cbiAgICogVml0ZSBkZXYgc2VydmVyIGZvciBkZXZlbG9wbWVudC5cbiAgICogYGZpbGU6Ly8uLi9yZW5kZXJlci9pbmRleC5odG1sYCBmb3IgcHJvZHVjdGlvbiBhbmQgdGVzdC5cbiAgICovXG4gIGNvbnN0IHBhZ2VVcmwgPVxuICAgIGltcG9ydC5tZXRhLmVudi5ERVYgJiYgaW1wb3J0Lm1ldGEuZW52LlZJVEVfREVWX1NFUlZFUl9VUkwgIT09IHVuZGVmaW5lZFxuICAgICAgPyBpbXBvcnQubWV0YS5lbnYuVklURV9ERVZfU0VSVkVSX1VSTFxuICAgICAgOiBuZXcgVVJMKCcuLi9yZW5kZXJlci9kaXN0L2luZGV4Lmh0bWwnLCAnZmlsZTovLycgKyBfX2Rpcm5hbWUpLnRvU3RyaW5nKCk7XG5cbiAgYXdhaXQgYnJvd3NlcldpbmRvdy5sb2FkVVJMKHBhZ2VVcmwpO1xuXG4gIHJldHVybiBicm93c2VyV2luZG93O1xufVxuXG5sZXQgd2luZG93OiBCcm93c2VyV2luZG93IHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0V2luZG93KCkge1xuICByZXR1cm4gd2luZG93O1xufVxuXG4vKipcbiAqIFJlc3RvcmUgYW4gZXhpc3RpbmcgQnJvd3NlcldpbmRvdyBvciBDcmVhdGUgYSBuZXcgQnJvd3NlcldpbmRvdy5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlc3RvcmVPckNyZWF0ZVdpbmRvdygpIHtcbiAgd2luZG93ID0gQnJvd3NlcldpbmRvdy5nZXRBbGxXaW5kb3dzKCkuZmluZCh3ID0+ICF3LmlzRGVzdHJveWVkKCkpO1xuXG4gIGlmICh3aW5kb3cgPT09IHVuZGVmaW5lZCkge1xuICAgIHdpbmRvdyA9IGF3YWl0IGNyZWF0ZVdpbmRvdygpO1xuICB9XG5cbiAgaWYgKHdpbmRvdy5pc01pbmltaXplZCgpKSB7XG4gICAgd2luZG93LnJlc3RvcmUoKTtcbiAgfVxuXG4gIHdpbmRvdy5mb2N1cygpO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQge1xuICBhcHA6IHtcbiAgICBnZXRQYXRoOiAnYXBwLmdldFBhdGgnLFxuICB9LFxuICBkaWFsb2c6ICdkaWFsb2cnLFxuICBwYXRoOiB7XG4gICAgcmVzb2x2ZTogJ3BhdGgucmVzb2x2ZScsXG4gICAgam9pbjogJ3BhdGguam9pbicsXG4gICAgc2VwOiAncGF0aC5zZXAnLFxuICB9LFxuICBmczoge1xuICAgIGV4aXN0c1N5bmM6ICdmcy5leGlzdHNTeW5jJyxcbiAgICByZW1vdmVTeW5jOiAnZnMucmVtb3ZlU3luYycsXG4gICAgZW1wdHlEaXJTeW5jOiAnZnMuZW1wdHlEaXJTeW5jJyxcbiAgfSxcbiAgc3RvcmU6IHtcbiAgICBnZXQ6ICdzdG9yZS5nZXQnLFxuICAgIHNldDogJ3N0b3JlLnNldCcsXG4gIH0sXG4gIGdpdDoge1xuICAgIHJlcG9zaXRvcnlBdXRoVXJsOiAnZ2l0LnJlcG9zaXRvcnlBdXRoVXJsJyxcbiAgICBicmFuY2hTdW1tYXJ5OiAnZ2l0LmJyYW5jaFN1bW1hcnknLFxuICAgIGxvZ1Jlc3VsdDogJ2dpdC5sb2dSZXN1bHQnLFxuICB9LFxufTtcbiIsImltcG9ydCB0eXBlIHtXaW5kb3dFbGVjdHJvblBhcmFtZXRlcnN9IGZyb20gJyoudnVlfHRzfHRzeCc7XG5pbXBvcnQgY2hhbm5lbCBmcm9tICdAL2NvbW1vbi9jaGFubmVsJztcbmltcG9ydCB7YXBwVGl0bGV9IGZyb20gJ0AvY29tbW9uL2luZGV4Lmpzb24nO1xuaW1wb3J0IHR5cGUge09wZW5EaWFsb2dPcHRpb25zfSBmcm9tICdlbGVjdHJvbic7XG5pbXBvcnQge2FwcCwgZGlhbG9nLCBpcGNNYWlufSBmcm9tICdlbGVjdHJvbic7XG5pbXBvcnQgU3RvcmUgZnJvbSAnZWxlY3Ryb24tc3RvcmUnO1xuaW1wb3J0IGZzIGZyb20gJ2ZzLWV4dHJhJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHR5cGUge0JyYW5jaFN1bW1hcnksIExvZ1Jlc3VsdCwgU2ltcGxlR2l0T3B0aW9uc30gZnJvbSAnc2ltcGxlLWdpdCc7XG5pbXBvcnQgc2ltcGxlR2l0IGZyb20gJ3NpbXBsZS1naXQnO1xuaW1wb3J0IHtVUkx9IGZyb20gJ3VybCc7XG5cbi8vXG4vLyBpcGNNYWluLmhhbmRsZShjaGFubmVsLmV4YW1wbGUsIGFzeW5jIChldmVudCwgLi4uYXJncykgPT4ge30pO1xuLy8gaXBjTWFpbi5vbihjaGFubmVsLmV4YW1wbGUsIGFzeW5jIChldmVudCwgLi4uYXJncykgPT4ge1xuLy8gICBldmVudC5yZXR1cm5WYWx1ZSA9ICcnO1xuLy8gfSk7XG4vLyBnZXRXaW5kb3coKT8ud2ViQ29udGVudHMuc2VuZChjaGFubmVsLmV4YW1wbGUsIGRhdGEpO1xuXG4vLyBlbGVjdHJvbiBzdGFydFxuaXBjTWFpbi5oYW5kbGUoY2hhbm5lbC5kaWFsb2csIGFzeW5jIChldmVudCwgb3B0aW9uczogT3BlbkRpYWxvZ09wdGlvbnMpID0+IHtcbiAgcmV0dXJuIGF3YWl0IGRpYWxvZy5zaG93T3BlbkRpYWxvZyhvcHRpb25zKTtcbn0pO1xuXG5pcGNNYWluLm9uKFxuICBjaGFubmVsLmFwcC5nZXRQYXRoLFxuICBhc3luYyAoZXZlbnQsIC4uLmFyZ3M6IFdpbmRvd0VsZWN0cm9uUGFyYW1ldGVyc1snYXBwJ11bJ2dldFBhdGgnXSkgPT4ge1xuICAgIGV2ZW50LnJldHVyblZhbHVlID0gYXBwLmdldFBhdGgoLi4uYXJncyk7XG4gIH0sXG4pO1xuLy8gZWxlY3Ryb24gZW5kXG5cbi8vIG5vZGUgc3RhcnRcbmlwY01haW4ub24oXG4gIGNoYW5uZWwucGF0aC5yZXNvbHZlLFxuICBhc3luYyAoZXZlbnQsIC4uLmFyZ3M6IFdpbmRvd0VsZWN0cm9uUGFyYW1ldGVyc1sncGF0aCddWydyZXNvbHZlJ10pID0+IHtcbiAgICBldmVudC5yZXR1cm5WYWx1ZSA9IHBhdGgucmVzb2x2ZSguLi5hcmdzKTtcbiAgfSxcbik7XG5cbmlwY01haW4ub24oY2hhbm5lbC5wYXRoLmpvaW4sIGFzeW5jIChldmVudCwgLi4uYXJnczogV2luZG93RWxlY3Ryb25QYXJhbWV0ZXJzWydwYXRoJ11bJ2pvaW4nXSkgPT4ge1xuICBldmVudC5yZXR1cm5WYWx1ZSA9IHBhdGguam9pbiguLi5hcmdzKTtcbn0pO1xuXG5pcGNNYWluLm9uKGNoYW5uZWwucGF0aC5zZXAsIGFzeW5jIGV2ZW50ID0+IHtcbiAgZXZlbnQucmV0dXJuVmFsdWUgPSBwYXRoLnNlcDtcbn0pO1xuXG5pcGNNYWluLm9uKFxuICBjaGFubmVsLmZzLmV4aXN0c1N5bmMsXG4gIGFzeW5jIChldmVudCwgLi4uYXJnczogV2luZG93RWxlY3Ryb25QYXJhbWV0ZXJzWydmcyddWydleGlzdHNTeW5jJ10pID0+IHtcbiAgICBldmVudC5yZXR1cm5WYWx1ZSA9IGZzLmV4aXN0c1N5bmMoLi4uYXJncyk7XG4gIH0sXG4pO1xuXG5pcGNNYWluLm9uKFxuICBjaGFubmVsLmZzLnJlbW92ZVN5bmMsXG4gIGFzeW5jIChldmVudCwgLi4uYXJnczogV2luZG93RWxlY3Ryb25QYXJhbWV0ZXJzWydmcyddWydyZW1vdmVTeW5jJ10pID0+IHtcbiAgICBldmVudC5yZXR1cm5WYWx1ZSA9IGZzLnJlbW92ZVN5bmMoLi4uYXJncyk7XG4gIH0sXG4pO1xuXG5pcGNNYWluLm9uKFxuICBjaGFubmVsLmZzLmVtcHR5RGlyU3luYyxcbiAgYXN5bmMgKGV2ZW50LCAuLi5hcmdzOiBXaW5kb3dFbGVjdHJvblBhcmFtZXRlcnNbJ2ZzJ11bJ2VtcHR5RGlyU3luYyddKSA9PiB7XG4gICAgZXZlbnQucmV0dXJuVmFsdWUgPSBmcy5lbXB0eURpclN5bmMoLi4uYXJncyk7XG4gIH0sXG4pO1xuXG4vLyBub2RlIGVuZFxuXG5jb25zdCBzdG9yZSA9IG5ldyBTdG9yZSh7XG4gIG5hbWU6ICdnaXQtbG9nLWV4dHJhY3QtbWFpbi1jb25maWcnLFxuICBjd2Q6IHBhdGguam9pbihhcHAuZ2V0UGF0aCgnYXBwRGF0YScpLCBhcHBUaXRsZSksXG59KTtcblxuaXBjTWFpbi5vbihjaGFubmVsLnN0b3JlLnNldCwgYXN5bmMgKGV2ZW50LCAuLi5hcmdzOiBXaW5kb3dFbGVjdHJvblBhcmFtZXRlcnNbJ3N0b3JlJ11bJ3NldCddKSA9PiB7XG4gIHN0b3JlLnNldCguLi5hcmdzKTtcbn0pO1xuXG5pcGNNYWluLm9uKGNoYW5uZWwuc3RvcmUuZ2V0LCBhc3luYyAoZXZlbnQsIGtleTogc3RyaW5nLCBkZWZhdWx0VmFsdWU/OiB1bmtub3duKSA9PiB7XG4gIGV2ZW50LnJldHVyblZhbHVlID0gc3RvcmUuZ2V0KGtleSwgZGVmYXVsdFZhbHVlKTtcbn0pO1xuXG5pcGNNYWluLmhhbmRsZShcbiAgY2hhbm5lbC5naXQucmVwb3NpdG9yeUF1dGhVcmwsXG4gIGFzeW5jIChldmVudCwgdXJsOiBzdHJpbmcsIHVzZXJuYW1lOiBzdHJpbmcsIHBhc3N3b3JkOiBzdHJpbmcpID0+IHtcbiAgICBjb25zdCB1cmxPYmogPSBuZXcgVVJMKHVybCk7XG4gICAgdXJsT2JqLnVzZXJuYW1lID0gdXNlcm5hbWU7XG4gICAgdXJsT2JqLnBhc3N3b3JkID0gcGFzc3dvcmQ7XG4gICAgcmV0dXJuIHVybE9iai5ocmVmO1xuICB9LFxuKTtcblxuZnVuY3Rpb24gY3JlYXRlR2l0KG9wdGlvbnM/OiBQYXJ0aWFsPFNpbXBsZUdpdE9wdGlvbnM+LCBvblByb2dyZXNzPzogKGRhdGE6IHN0cmluZykgPT4gdm9pZCkge1xuICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgb3B0aW9ucyA9IHtiYXNlRGlyOiAnJ307XG4gIH1cbiAgLy8gaWYgKG9uUHJvZ3Jlc3MpIHtcbiAgLy8gICBvcHRpb25zLnByb2dyZXNzICA9IChkYXRhOiBTaW1wbGVHaXRQcm9ncmVzc0V2ZW50KSA9PiB7XG4gIC8vICAgICBjb25zb2xlLmxvZyhcbiAgLy8gICAgICAgYGdpdC4ke2RhdGEubWV0aG9kfSAke2RhdGEuc3RhZ2V9IHN0YWdlICR7ZGF0YS5wcm9ncmVzc30lIGNvbXBsZXRlYFxuICAvLyAgICAgKTtcbiAgLy8gICAgIG9uUHJvZ3Jlc3MoZGF0YSk7XG4gIC8vICAgfTtcbiAgLy8gfVxuICBjb25zdCBnaXQgPSBzaW1wbGVHaXQob3B0aW9ucyk7XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICBnaXQub3V0cHV0SGFuZGxlcigoYmluLCBzdGRvdXQsIHN0ZGVyciwgYXJncykgPT4ge1xuICAgIHN0ZG91dC5waXBlKHByb2Nlc3Muc3Rkb3V0KTtcbiAgICBzdGRlcnIucGlwZShwcm9jZXNzLnN0ZGVycik7XG4gICAgc3RkZXJyLm9uKCdkYXRhJywgZnVuY3Rpb24gKHN0ZERhdGE6IHt0b1N0cmluZzogKCkgPT4gc3RyaW5nfSkge1xuICAgICAgLy8gY29uc29sZS5sb2coc3RkRGF0YS50b1N0cmluZygpKTtcbiAgICAgIGlmIChvblByb2dyZXNzKSB7XG4gICAgICAgIG9uUHJvZ3Jlc3Moc3RkRGF0YS50b1N0cmluZygpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG4gIHJldHVybiBnaXQ7XG59XG5cbmlwY01haW4uaGFuZGxlKFxuICBjaGFubmVsLmdpdC5icmFuY2hTdW1tYXJ5LFxuICBhc3luYyAoZXZlbnQsIGRpcmVjdG9yeVBhdGg6IHN0cmluZywgcmVwb3NpdG9yeUF1dGhVcmw6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IGdpdCA9IGNyZWF0ZUdpdCh7XG4gICAgICBiYXNlRGlyOiBkaXJlY3RvcnlQYXRoLFxuICAgIH0pO1xuICAgIGF3YWl0IGdpdC5pbml0KCk7XG4gICAgYXdhaXQgZ2l0LmFkZFJlbW90ZSgnb3JpZ2luJywgcmVwb3NpdG9yeUF1dGhVcmwpO1xuICAgIGF3YWl0IGdpdC5mZXRjaChbJy0tc2hhbGxvdy1zaW5jZT1cIjEgbW9udGhzIGFnb1wiJ10pO1xuICAgIC8vIGF3YWl0IGdpdC5yZW1vdGUoW1widXBkYXRlXCJdKTtcbiAgICBjb25zdCBicmFuY2hTdW1tYXJ5OiBCcmFuY2hTdW1tYXJ5ID0gYXdhaXQgZ2l0LmJyYW5jaChbJy1yJ10pO1xuICAgIHJldHVybiBicmFuY2hTdW1tYXJ5O1xuICB9LFxuKTtcblxuaXBjTWFpbi5oYW5kbGUoXG4gIGNoYW5uZWwuZ2l0LmxvZ1Jlc3VsdCxcbiAgYXN5bmMgKGV2ZW50LCBkaXJlY3RvcnlQYXRoOiBzdHJpbmcsIGxvZ09wdGlvbnM6IHN0cmluZ1tdKSA9PiB7XG4gICAgY29uc3QgZ2l0ID0gY3JlYXRlR2l0KHtiYXNlRGlyOiBkaXJlY3RvcnlQYXRofSk7XG4gICAgYXdhaXQgZ2l0LmZldGNoKFsnLS1zaGFsbG93LXNpbmNlPVwiMSBtb250aHMgYWdvXCInXSk7XG4gICAgLy8gY29uc29sZS5sb2coJ2dpdCAxJyk7XG4gICAgLy8gYXdhaXQgZ2l0LnJlbW90ZShbXCJ1cGRhdGVcIl0pO1xuICAgIC8vIC8vIGNvbnNvbGUubG9nKCdnaXQgMicpO1xuICAgIGNvbnN0IGxvZ1Jlc3VsdDogTG9nUmVzdWx0ID0gYXdhaXQgZ2l0LmxvZyhsb2dPcHRpb25zKTtcbiAgICAvLyBjb25zb2xlLmxvZygnZ2l0IDMnKTtcbiAgICByZXR1cm4gbG9nUmVzdWx0O1xuICB9LFxuKTtcbiIsImltcG9ydCB7cmVzdG9yZU9yQ3JlYXRlV2luZG93fSBmcm9tICdAL21haW4vbWFpbldpbmRvdyc7XG5pbXBvcnQge2FwcH0gZnJvbSAnZWxlY3Ryb24nO1xuaW1wb3J0ICcuL2lwY01haW5MaXN0ZW5lcic7XG4vKipcbiAqIFByZXZlbnQgZWxlY3Ryb24gZnJvbSBydW5uaW5nIG11bHRpcGxlIGluc3RhbmNlcy5cbiAqL1xuY29uc3QgaXNTaW5nbGVJbnN0YW5jZSA9IGFwcC5yZXF1ZXN0U2luZ2xlSW5zdGFuY2VMb2NrKCk7XG5pZiAoIWlzU2luZ2xlSW5zdGFuY2UpIHtcbiAgYXBwLnF1aXQoKTtcbiAgcHJvY2Vzcy5leGl0KDApO1xufVxuYXBwLm9uKCdzZWNvbmQtaW5zdGFuY2UnLCByZXN0b3JlT3JDcmVhdGVXaW5kb3cpO1xuXG4vKipcbiAqIERpc2FibGUgSGFyZHdhcmUgQWNjZWxlcmF0aW9uIHRvIHNhdmUgbW9yZSBzeXN0ZW0gcmVzb3VyY2VzLlxuICovXG5hcHAuZGlzYWJsZUhhcmR3YXJlQWNjZWxlcmF0aW9uKCk7XG5cbi8qKlxuICogU2hvdXQgZG93biBiYWNrZ3JvdW5kIHByb2Nlc3MgaWYgYWxsIHdpbmRvd3Mgd2FzIGNsb3NlZFxuICovXG5hcHAub24oJ3dpbmRvdy1hbGwtY2xvc2VkJywgKCkgPT4ge1xuICBpZiAocHJvY2Vzcy5wbGF0Zm9ybSAhPT0gJ2RhcndpbicpIHtcbiAgICBhcHAucXVpdCgpO1xuICB9XG59KTtcblxuLyoqXG4gKiBAc2VlIGh0dHBzOi8vd3d3LmVsZWN0cm9uanMub3JnL2RvY3MvbGF0ZXN0L2FwaS9hcHAjZXZlbnQtYWN0aXZhdGUtbWFjb3MgRXZlbnQ6ICdhY3RpdmF0ZScuXG4gKi9cbmFwcC5vbignYWN0aXZhdGUnLCByZXN0b3JlT3JDcmVhdGVXaW5kb3cpO1xuXG4vKipcbiAqIENyZWF0ZSB0aGUgYXBwbGljYXRpb24gd2luZG93IHdoZW4gdGhlIGJhY2tncm91bmQgcHJvY2VzcyBpcyByZWFkeS5cbiAqL1xuYXBwXG4gIC53aGVuUmVhZHkoKVxuICAudGhlbihyZXN0b3JlT3JDcmVhdGVXaW5kb3cpXG4gIC5jYXRjaChlID0+IGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCBjcmVhdGUgd2luZG93OicsIGUpKTtcblxuLyoqXG4gKiBJbnN0YWxsIFZ1ZS5qcyBvciBhbnkgb3RoZXIgZXh0ZW5zaW9uIGluIGRldmVsb3BtZW50IG1vZGUgb25seS5cbiAqIE5vdGU6IFlvdSBtdXN0IGluc3RhbGwgYGVsZWN0cm9uLWRldnRvb2xzLWluc3RhbGxlcmAgbWFudWFsbHlcbiAqL1xuLy8gaWYgKGltcG9ydC5tZXRhLmVudi5ERVYpIHtcbi8vICAgYXBwLndoZW5SZWFkeSgpXG4vLyAgICAgLnRoZW4oKCkgPT4gaW1wb3J0KCdlbGVjdHJvbi1kZXZ0b29scy1pbnN0YWxsZXInKSlcbi8vICAgICAudGhlbigoe2RlZmF1bHQ6IGluc3RhbGxFeHRlbnNpb24sIFZVRUpTM19ERVZUT09MU30pID0+IGluc3RhbGxFeHRlbnNpb24oVlVFSlMzX0RFVlRPT0xTLCB7XG4vLyAgICAgICBsb2FkRXh0ZW5zaW9uT3B0aW9uczoge1xuLy8gICAgICAgICBhbGxvd0ZpbGVBY2Nlc3M6IHRydWUsXG4vLyAgICAgICB9LFxuLy8gICAgIH0pKVxuLy8gICAgIC5jYXRjaChlID0+IGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCBpbnN0YWxsIGV4dGVuc2lvbjonLCBlKSk7XG4vLyB9XG5cbi8qKlxuICogQ2hlY2sgZm9yIG5ldyB2ZXJzaW9uIG9mIHRoZSBhcHBsaWNhdGlvbiAtIHByb2R1Y3Rpb24gbW9kZSBvbmx5LlxuICovXG5pZiAoaW1wb3J0Lm1ldGEuZW52LlBST0QpIHtcbiAgYXBwXG4gICAgLndoZW5SZWFkeSgpXG4gICAgLnRoZW4oKCkgPT4gaW1wb3J0KCdlbGVjdHJvbi11cGRhdGVyJykpXG4gICAgLnRoZW4oKHthdXRvVXBkYXRlcn0pID0+IGF1dG9VcGRhdGVyLmNoZWNrRm9yVXBkYXRlc0FuZE5vdGlmeSgpKVxuICAgIC5jYXRjaChlID0+IGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCBjaGVjayB1cGRhdGVzOicsIGUpKTtcbn1cbiJdLCJuYW1lcyI6WyJCcm93c2VyV2luZG93Iiwiam9pbiIsImFwcCIsImlwY01haW4i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
